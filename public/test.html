<!DOCTYPE html>
<html>
<head>
    <title>Razorpay Test</title>
</head>
<body>
    <h1>Razorpay Test</h1>
    <form id="orderForm" onsubmit="return false;">
        <div>
            <label>Amount (in paise):
                <input type="number" id="amount" value="1000" min="100" />
            </label>
        </div>
        <div>
            <label>Currency:
                <input type="text" id="currency" value="INR" />
            </label>
        </div>
        <div>
            <label>Receipt ID:
                <input type="text" id="receipt" value="test123" />
            </label>
        </div>
        <button type="button" onclick="testRazorpay()">Create Order</button>
    </form>
    <pre id="result"></pre>
    <script>
        async function testRazorpay() {
            const result = document.getElementById('result');
            result.textContent = 'Sending request...';
            
            try {
                const amount = document.getElementById('amount').value;
                const currency = document.getElementById('currency').value;
                const receipt = document.getElementById('receipt').value;
                
                const response = await fetch('http://localhost:5001/api/razorpay/create-order', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        amount: parseInt(amount, 10),
                        currency: currency,
                        receipt: receipt
                    })
                });
                
                const responseText = await response.text();
                let data;
                try {
                    data = JSON.parse(responseText);
                } catch (e) {
                    document.getElementById('result').textContent = 'Response (not JSON): ' + responseText;
                    return;
                }
                
                document.getElementById('result').innerHTML = `
                    Status: ${response.status} ${response.statusText}<br>
                    Headers: ${JSON.stringify(Object.fromEntries(response.headers.entries()), null, 2)}<br>
                    Data: ${JSON.stringify(data, null, 2)}
                `;
            } catch (error) {
                document.getElementById('result').innerHTML = `
                    Error Type: ${error.name}<br>
                    Message: ${error.message}<br>
                    Stack: ${error.stack}
                `;
            }
        }
        
        testRazorpay();
    </script>
</body>
</html>